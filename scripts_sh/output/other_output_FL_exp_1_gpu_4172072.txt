
CondaError: Run 'conda init' before 'conda activate'

[sdist]
dist/alzheimer_deep_learning_detection-0.0.1.tar.gz

[wheel]
dist/alzheimer_deep_learning_detection-0.0.1-py2.py3-none-any.whl
wandb: Currently logged in as: jesus_333 to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/wandb/analytics/sentry.py:259: DeprecationWarning: The `Scope.user` setter is deprecated in favor of `Scope.set_user()`.
  self.scope.user = {"email": email}  # noqa
/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/wandb/analytics/sentry.py:259: DeprecationWarning: The `Scope.user` setter is deprecated in favor of `Scope.set_user()`.
  self.scope.user = {"email": email}  # noqa
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /mnt/aiongpfs/users/azancanaro/DL_for_AD_detection/wandb/run-20250612_193842-7yazicw0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eternal-cherry-5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/jesus_333/demnet_training_ADNI_FL
wandb: üöÄ View run at https://wandb.ai/jesus_333/demnet_training_ADNI_FL/runs/7yazicw0
wandb: logging graph, to disable use `wandb.watch(log_graph=False)`
/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
[92mINFO [0m:      Starting Flower ServerApp, config: num_rounds=10, no round_timeout
[92mINFO [0m:      
[92mINFO [0m:      [INIT]
[92mINFO [0m:      Using initial global parameters provided by strategy
[92mINFO [0m:      Starting evaluation of initial global parameters
[92mINFO [0m:      Evaluation returned no results (`None`)
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 8 clients (out of 8)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 142, in train
    train_loss = train_epoch_function(model, train_loader, loss_function, optimizer,
                                      training_config['device'], log_dict, training_config['print_var']
                                      )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 322, in train_epoch_function
    batch_train_loss = loss_function(pred_label, true_label)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/loss.py", line 1297, in forward
    return F.cross_entropy(
           ~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
    ...<4 lines>...
        label_smoothing=self.label_smoothing,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
    ...<4 lines>...
        label_smoothing,
        ^^^^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 142, in train
    train_loss = train_epoch_function(model, train_loader, loss_function, optimizer,
                                      training_config['device'], log_dict, training_config['print_var']
                                      )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 322, in train_epoch_function
    batch_train_loss = loss_function(pred_label, true_label)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/loss.py", line 1297, in forward
    return F.cross_entropy(
           ~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
    ...<4 lines>...
        label_smoothing=self.label_smoothing,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
    ...<4 lines>...
        label_smoothing,
        ^^^^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [1,0,0] Assertion `t >= 0 && t < n_classes` failed.
[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [7,0,0] Assertion `t >= 0 && t < n_classes` failed.
[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [9,0,0] Assertion `t >= 0 && t < n_classes` failed.
[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [10,0,0] Assertion `t >= 0 && t < n_classes` failed.
[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [11,0,0] Assertion `t >= 0 && t < n_classes` failed.
[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [12,0,0] Assertion `t >= 0 && t < n_classes` failed.
[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [13,0,0] Assertion `t >= 0 && t < n_classes` failed.
[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [15,0,0] Assertion `t >= 0 && t < n_classes` failed.
[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [17,0,0] Assertion `t >= 0 && t < n_classes` failed.
[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [18,0,0] Assertion `t >= 0 && t < n_classes` failed.
[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [20,0,0] Assertion `t >= 0 && t < n_classes` failed.
[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [21,0,0] Assertion `t >= 0 && t < n_classes` failed.
[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [23,0,0] Assertion `t >= 0 && t < n_classes` failed.
[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [24,0,0] Assertion `t >= 0 && t < n_classes` failed.
[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [27,0,0] Assertion `t >= 0 && t < n_classes` failed.
[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [30,0,0] Assertion `t >= 0 && t < n_classes` failed.
[36m(ClientAppActor pid=2259743)[0m /pytorch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [31,0,0] Assertion `t >= 0 && t < n_classes` failed.
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[92mINFO [0m:      aggregate_fit: received 0 results and 8 failures
[92mINFO [0m:      configure_evaluate: strategy sampled 8 clients (out of 8)
[92mINFO [0m:      aggregate_evaluate: received 0 results and 8 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 8 clients (out of 8)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[92mINFO [0m:      aggregate_fit: received 0 results and 8 failures
[92mINFO [0m:      configure_evaluate: strategy sampled 8 clients (out of 8)
[92mINFO [0m:      aggregate_evaluate: received 0 results and 8 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 8 clients (out of 8)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[92mINFO [0m:      aggregate_fit: received 0 results and 8 failures
[92mINFO [0m:      configure_evaluate: strategy sampled 8 clients (out of 8)
[92mINFO [0m:      aggregate_evaluate: received 0 results and 8 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 8 clients (out of 8)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 111, in worker
    out_mssg, updated_context = backend.process_message(message, context)
                                ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
                                   ~~~~~~~^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
        client_fn=client_fn, message=message, context=context
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
        client=client,
        fit_ins=recorddict_to_fitins(message.content, keep_input=True),
    )
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
           ~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/federated/client.py", line 77, in fit
    self.model, training_metrics = train_functions.train(self.training_config, self.model, self.train_dataset, self.validation_dataset)
                                   ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/addl/training/train_functions.py", line 99, in train
    model.to(training_config['device'])
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1355, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 915, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 942, in _apply
    param_applied = fn(param)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1341, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2259743, ip=172.17.6.197, actor_id=f22a3c66802d21d356507d7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7fffc0105a90>)
  File "/home/users/azancanaro/miniconda3/envs/jesus-hpc/lib/python3.13/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
srun: got SIGCONT
slurmstepd: error: *** STEP 4172072.6 ON iris-197 CANCELLED AT 2025-06-12T19:40:25 ***
*** SIGTERM received at time=1749750025 on cpu 0 ***
PC: @     0x7ffff7bbddc6  (unknown)  do_futex_wait.constprop.1
    @     0x7ffff7bbfd10  641254864  (unknown)
    @ ... and at least 1 more frames
[2025-06-12 19:40:25,797 E 2259034 2259034] logging.cc:496: *** SIGTERM received at time=1749750025 on cpu 0 ***
[2025-06-12 19:40:25,797 E 2259034 2259034] logging.cc:496: PC: @     0x7ffff7bbddc6  (unknown)  do_futex_wait.constprop.1
[2025-06-12 19:40:25,797 E 2259034 2259034] logging.cc:496:     @     0x7ffff7bbfd10  641254864  (unknown)
[2025-06-12 19:40:25,797 E 2259034 2259034] logging.cc:496:     @ ... and at least 1 more frames
slurmstepd: error: *** JOB 4172072 ON iris-197 CANCELLED AT 2025-06-12T19:40:25 ***
srun: forcing job termination
